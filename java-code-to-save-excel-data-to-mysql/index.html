<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta charset="utf-8"><meta name="description" content="Code reffernce directry."><meta name="generator" content="11ty"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="manifest" href="/site.webmanifest"><title>java code to save excel data to mysql</title><link rel="stylesheet" href="/site.css"><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/go.min.js"></script></head><body class="font-sans leading-normal tracking-normal text-gray-900 bg-gray-100"><script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js" defer="defer"></script><nav class="bg-gray-800" x-data="{ menu : false }"><div class="mx-auto px-2 sm:px-6 lg:px-8"><div class="relative flex items-center justify-between h-16"><div class="absolute inset-y-0 left-0 flex items-center sm:hidden"><button @click="menu = !menu" type="button" class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-white hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white" aria-controls="mobile-menu" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg> <svg class="hidden h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg></button></div><div class="flex-1 flex items-center justify-center sm:items-stretch sm:justify-start"><a href="/"><div class="flex-shrink-0 flex items-center"><svg class="block h-8 w-auto" width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-file-code-fill" fill="#ffffff" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M12 1H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2zM6.646 5.646a.5.5 0 1 1 .708.708L5.707 8l1.647 1.646a.5.5 0 0 1-.708.708l-2-2a.5.5 0 0 1 0-.708l2-2zm2.708 0a.5.5 0 1 0-.708.708L10.293 8 8.646 9.646a.5.5 0 0 0 .708.708l2-2a.5.5 0 0 0 0-.708l-2-2z"/></svg><logo class="ml-1 text-white text-2xl font-bold">foones</logo></div></a><div class="hidden sm:block sm:ml-6"><div class="flex space-x-4"><a href="/" class="bg-gray-900 text-white px-3 py-2 rounded-md text-sm font-medium">Home</a> <a href="/archive/" class="text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Browse</a></div></div></div><div class="absolute inset-y-0 right-0 flex items-center pr-2 sm:static sm:inset-auto sm:ml-6 sm:pr-0"><button class="bg-gray-800 p-1 rounded-full text-gray-400 hover:text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-white"><span class="sr-only">View notifications</span><svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"/></svg></button><div x-data="{ isOpen: false }" class="ml-3 relative"><div><button @click="isOpen = !isOpen" class="bg-gray-800 flex text-sm rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-white" id="user-menu" aria-haspopup="true"><span class="sr-only">Open user menu</span> <img class="h-8 w-8 rounded-full" src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80" alt=""></button></div><div x-show="isOpen" x-transition:enter="transition ease-out duration-100 transform" x-transition:enter-start="opacity-0 scale-95" x-transition:enter-end="opacity-100 scale-100" x-transition:leave="transition ease-in duration-75 transform" x-transition:leave-start="opacity-100 scale-100" x-transition:leave-end="opacity-0 scale-95" class="z-20 origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg py-1 bg-white ring-1 ring-black ring-opacity-5" role="menu" aria-orientation="vertical" aria-labelledby="user-menu" x-show="false"><a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" role="menuitem">Your Profile</a> <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" role="menuitem">Settings</a> <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" role="menuitem">Sign out</a></div></div></div></div></div><div x-show="menu" class="sm:hidden" id="mobile-menu"><div class="px-2 pt-2 pb-3 space-y-1"><a href="/" class="bg-gray-900 text-white block px-3 py-2 rounded-md text-base font-medium">Home</a> <a href="/archive/" class="text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium">Browse</a></div></div></nav><main class="p-4 m-4 max-w-4xl mx-auto"><h1 class="py-2 text-2xl font-bold leading-7 text-gray-900 sm:text-3xl">java code to save excel data to mysql</h1><div class="my-2 flex items-center text-sm text-gray-500"><svg class="flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M6 6V5a3 3 0 013-3h2a3 3 0 013 3v1h2a2 2 0 012 2v3.57A22.952 22.952 0 0110 13a22.95 22.95 0 01-8-1.43V8a2 2 0 012-2h2zm2-1a1 1 0 011-1h2a1 1 0 011 1v1H8V5zm1 5a1 1 0 011-1h.01a1 1 0 110 2H10a1 1 0 01-1-1z" clip-rule="evenodd"/><path d="M2 13.692V16a2 2 0 002 2h12a2 2 0 002-2v-2.308A24.974 24.974 0 0110 15c-2.796 0-5.487-.46-8-1.308z"/></svg> Java</div><pre><code> &lt;%@ page language=&quot;java&quot; import=&quot;java.sql.*&quot; contentType=&quot;text/html; charset=ISO-8859-1&quot;  
   pageEncoding=&quot;ISO-8859-1&quot;%&gt;  
 &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;  
 &lt;%@ page import =&quot;java.util.Date&quot; %&gt;  
 &lt;%@ page import =&quot;java.io.*&quot; %&gt;  
 &lt;%@ page import =&quot;java.io.FileNotFoundException&quot; %&gt;  
 &lt;%@ page import =&quot;java.io.IOException&quot; %&gt;  
 &lt;%@ page import =&quot;java.util.Iterator&quot; %&gt;  
 &lt;%@ page import =&quot;java.util.ArrayList&quot; %&gt;  
 //Apache POI Libraries  
 &lt;%@ page import =&quot;org.apache.poi.hssf.usermodel.HSSFCell&quot; %&gt;  
 &lt;%@ page import =&quot;org.apache.poi.hssf.usermodel.HSSFRow&quot; %&gt;  
 &lt;%@ page import =&quot;org.apache.poi.hssf.usermodel.HSSFSheet&quot; %&gt;  
 &lt;%@ page import =&quot;org.apache.poi.hssf.usermodel.HSSFWorkbook&quot; %&gt;  
 &lt;%@ page import =&quot;org.apache.poi.poifs.filesystem.POIFSFileSystem&quot; %&gt;  
 &lt;html&gt;  
 &lt;head&gt;  
 &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;  
 &lt;title&gt;Insert title here&lt;/title&gt;  
 &lt;/head&gt;  
 &lt;body&gt;  
 &lt;jsp:useBean id=&quot;connection&quot; class=&quot;DB.DB_Connection&quot; scope=&quot;page&quot;&gt;  
   &lt;jsp:setProperty name=&quot;connection&quot; property=&quot;*&quot;/&gt;  
 &lt;/jsp:useBean&gt;  
 &lt;%!    
 Connection con;  
 PreparedStatement ps=null;  
 public static ArrayList readExcelFile(String fileName)  
 {  
   /** --Define a ArrayList  
     --Holds ArrayList Of Cells  
    */  
   ArrayList cellArrayLisstHolder = new ArrayList();  
   try{  
   /** Creating Input Stream**/  
     FileInputStream myInput = new FileInputStream(fileName);  
   /** Create a POIFSFileSystem object**/  
   POIFSFileSystem myFileSystem = new POIFSFileSystem(myInput);  
   /** Create a workbook using the File System**/  
    HSSFWorkbook myWorkBook = new HSSFWorkbook(myFileSystem);  
    /** Get the first sheet from workbook**/  
   HSSFSheet mySheet = myWorkBook.getSheetAt(0);  
   /** We now need something to iterate through the cells.**/  
    Iterator rowIter = mySheet.rowIterator();  
    while(rowIter.hasNext()){  
      HSSFRow myRow = (HSSFRow) rowIter.next();  
      Iterator cellIter = myRow.cellIterator();  
      ArrayList cellStoreArrayList=new ArrayList();  
      while(cellIter.hasNext()){  
        HSSFCell myCell = (HSSFCell) cellIter.next();  
        cellStoreArrayList.add(myCell);  
      }  
      cellArrayLisstHolder.add(cellStoreArrayList);  
    }  
   }catch (Exception e){e.printStackTrace(); }  
   return cellArrayLisstHolder;  
 }%&gt;  
 &lt;%  
 String fileName=&quot;testExcel.xls&quot;; //testExcel.xls Excel File name  
 //Read an Excel File and Store in a ArrayList  
 ArrayList dataHolder=readExcelFile(fileName);  
 //Print the data read  
 //printCellDataToConsole(dataHolder);  
 con=connection.getConn();  
 String query=&quot;insert into Student values(?,?,?)&quot;;  
 ps=con.prepareStatement(query);  
 int count=0;  
 ArrayList cellStoreArrayList=null;  
 //For inserting into database  
 for (int i=1;i &lt; dataHolder.size(); i++) {  
   cellStoreArrayList=(ArrayList)dataHolder.get(i);  
     ps.setString(1,((HSSFCell)cellStoreArrayList.get(0)).toString());  
     ps.setString(2,((HSSFCell)cellStoreArrayList.get(1)).toString());  
     ps.setString(3,((HSSFCell)cellStoreArrayList.get(2)).toString());  
    count= ps.executeUpdate();  
     System.out.print(((HSSFCell)cellStoreArrayList.get(2)).toString() + &quot;t&quot;);  
     }  
 //For checking data is inserted or not?  
   if(count&gt;0)  
     { %&gt;  
         Following deatils from Excel file have been inserted in student table of database  
           &lt;table&gt;  
             &lt;tr&gt;  
               &lt;th&gt;Student's Name&lt;/th&gt;  
               &lt;th&gt;Class&lt;/th&gt;  
               &lt;th&gt;Age&lt;/th&gt;  
             &lt;/tr&gt;  
     &lt;% for (int i=1;i &lt; dataHolder.size(); i++) {  
   cellStoreArrayList=(ArrayList)dataHolder.get(i);%&gt;  
   &lt;tr&gt;  
     &lt;td&gt;&lt;%=((HSSFCell)cellStoreArrayList.get(0)).toString() %&gt;&lt;/td&gt;  
     &lt;td&gt;&lt;%=((HSSFCell)cellStoreArrayList.get(1)).toString() %&gt;&lt;/td&gt;  
     &lt;td&gt;&lt;%=((HSSFCell)cellStoreArrayList.get(2)).toString() %&gt;&lt;/td&gt;  
   &lt;/tr&gt;  
     &lt;%}  
    }  
   else  
   { %&gt;  
   &lt;center&gt; Details have not been inserted!!!!!!!!!&lt;/center&gt;  
   &lt;%  }  %&gt;  
     &lt;/table&gt;  
 &lt;/body&gt;  
 &lt;/html&gt;  
   import java.io.*;
      import java.sql.*;
      import java.util.*;
      import java.util.regex.*;
      import org.apache.poi.hssf.usermodel.*;
      import org.apache.poi.poifs.filesystem.POIFSFileSystem;
     
      public class Insert {
      public static void main( String [] args ) {
    	String fileName=&quot;C:\\File.xls&quot;;
    	Vector dataHolder=read(fileName);
    	saveToDatabase(dataHolder);
    }
	public static Vector read(String fileName)    {
    	Vector cellVectorHolder = new Vector();
    	try{
    		FileInputStream myInput = new FileInputStream(fileName);
   	    	POIFSFileSystem myFileSystem = new POIFSFileSystem(myInput);
            HSSFWorkbook myWorkBook = new HSSFWorkbook(myFileSystem);
            HSSFSheet mySheet = myWorkBook.getSheetAt(0);
           Iterator rowIter = mySheet.rowIterator(); 
           while(rowIter.hasNext()){
        	  HSSFRow myRow = (HSSFRow) rowIter.next();
        	  Iterator cellIter = myRow.cellIterator();
        	  Vector cellStoreVector=new Vector();
        	  while(cellIter.hasNext()){
        		  HSSFCell myCell = (HSSFCell) cellIter.next();
        		  cellStoreVector.addElement(myCell);
        	  }
        	  cellVectorHolder.addElement(cellStoreVector);
          }
    	}catch (Exception e){e.printStackTrace(); }
    	return cellVectorHolder;
    }
	private static void saveToDatabase(Vector dataHolder) {
        String username=&quot;&quot;;
		String password=&quot;&quot;;
		for (int i=0;i&lt;dataHolder.size(); i++){
                   Vector cellStoreVector=(Vector)dataHolder.elementAt(i);
			for (int j=0; j &lt; cellStoreVector.size();j++){
				HSSFCell myCell = (HSSFCell)cellStoreVector.elementAt(j);
				String st = myCell.toString();
				 username=st.substring(0,1);
				 password=st.substring(0);
							}
			try{
    Class.forName(&quot;com.mysql.jdbc.Driver&quot;).newInstance();
    Connection con = DriverManager.getConnection(&quot;jdbc:mysql://localhost:3306/test&quot;,&quot;root&quot;, &quot;root&quot;);
	Statement stat=con.createStatement();
	int k=stat.executeUpdate(&quot;insert into login(username,password) value('&quot;+username+&quot;','&quot;+password+&quot;')&quot;);
	System.out.println(&quot;Data is inserted&quot;);
	stat.close();
	con.close();
	}
	catch(Exception e){}
	}
	}
      }
     package DB;  
 import java.sql.Connection;  
 import java.sql.DriverManager;  
 import java.sql.SQLException;  
 public class DB_Connection {  
   private Connection con;  
    public DB_Connection()  
   {  
          try  
         {  
               String conUrl=&quot;jdbc:mysql://localhost:3306/MyTestDb&quot;;  
               String userName=&quot;root&quot;;  
               String pass=&quot;root&quot;;  
               Class.forName(&quot;com.mysql.jdbc.Driver&quot;);  
                 con=DriverManager.getConnection(conUrl,userName,pass);  
         }  
         catch(SQLException s)  
         {  
             System.out.println(s);  
         }  
         catch(ClassNotFoundException c)  
         {  
              System.out.println(c);  
         }  
   }  
   public Connection getConn() {  
     return con;  
   }  
   public void setConn(Connection con) {  
     this.con = con;  
   }  
 }  

</code></pre><ul><li></li></ul><div class="flex text-right mt-4"><span class="block mr-3"><a href="http://java2career.com/2012/10/insert-data-into-database-from-excel.html" class="inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"><svg class="-ml-1 mr-2 h-5 w-5 text-gray-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd"/></svg> Source </a></span><button x-data="{saved:false}" @click="saved = !saved" type="button" class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"><svg x-show="saved" class="-ml-1 mr-2 h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg> <svg x-show="!saved" class="-ml-1 mr-2 h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z" clip-rule="evenodd"/></svg> Save</button></div></main><script>hljs.initHighlightingOnLoad();
    //hljs.initLineNumbersOnLoad();</script><footer class="text-center text-xs p-4 border-t">© 2021 foones.com</footer></body></html>